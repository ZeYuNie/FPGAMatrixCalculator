# BRAM 模块

## 概述

Block RAM 存储模块，支持同步读写操作。默认配置为 8192 个存储单元（32KB）。

## 参数

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `DATA_WIDTH` | 32 | 数据位宽（bit） |
| `DEPTH` | 8192 + 1024 | 存储深度（存储单元数量） |
| `ADDR_WIDTH` | `$clog2(DEPTH)` | 地址位宽（自动计算） |

## 端口

| 端口 | 方向 | 位宽 | 说明 |
|------|------|------|------|
| `clk` | input | 1 | 时钟信号 |
| `rst_n` | input | 1 | 低电平异步复位（仅复位输出） |
| `wr_en` | input | 1 | 写使能 |
| `addr` | input | `ADDR_WIDTH` | 读写地址 |
| `din` | input | `DATA_WIDTH` | 写入数据 |
| `dout` | output | `DATA_WIDTH` | 读出数据 |

## 时序特性

### 写操作

- 时钟上升沿触发
- `wr_en` 高电平时，将 `din` 写入 `addr` 对应地址
- 写入延迟：1 个时钟周期

### 读操作

- 时钟上升沿触发
- 在 `addr` 上设置地址后，下一个时钟上升沿 `dout` 更新
- 读取延迟：1 个时钟周期

### 同时读写

- 允许对同一地址同时读写
- 读出的是**写入前**的旧数据（read-first）

## 复位行为

`rst_n` 仅复位输出寄存器，**不清空内存内容**。若需清空内存，必须显式写入所有地址。

## 使用示例

### 默认配置（(8192 + 1024) x 32bit）

```systemverilog
matrix_bram bram_inst (
    .clk(clk),
    .rst_n(rst_n),
    .wr_en(write_enable),
    .addr(address),
    .din(data_in),
    .dout(data_out)
);
```

### 自定义配置（1024 x 64bit）

```systemverilog
matrix_bram #(
    .DATA_WIDTH(64),
    .DEPTH(1024)
) bram_inst (
    .clk(clk),
    .rst_n(rst_n),
    .wr_en(write_enable),
    .addr(address),
    .din(data_in),
    .dout(data_out)
);
```

### 写入数据

```systemverilog
wr_en <= 1'b1;
addr <= 5'd10;
din <= 32'hDEADBEEF;
@(posedge clk);
```

### 读取数据

```systemverilog
wr_en <= 1'b0;
addr <= 5'd10;
@(posedge clk);
@(posedge clk);
// 此时 dout 包含地址 10 的数据
```

## 设计说明

此模块为通用的 BRAM 存储模块，可用于各种数据存储需求。适合存储中等规模的数据结构。
